<div>
  <div ref="node" :id="id"
    @mouseup="onMouseup"
    @mousedown="onMousedown"
    v-global-click="globalClick"
    @contextmenu.prevent.stop="$refs.contextMenu.open"
  >
    <transition name="fade">
      <node-cover v-if="!isIconized && coverText" :text="coverText"></node-cover>
    </transition>
    <node-label v-if="isLabelVisible && nodeLabelsVisible" :text="label" :maxWidth="width"></node-label>
    <transition name="fade">
      <div ref="content" v-show="!isIconized && !isAnimating" class="content">
        <!-- node-content -->
      </div>
    </transition>
    <transition name="fade">
      <div ref="icon" v-if="isIconized && !isAnimating" class="icon">
        <img :src="getIconPath">
      </div>
    </transition>
    <div ref="background" class="background" :class="{ active: isActive, selected: isSelected }"></div>
    <div class="input port-group">
      <div v-for="(port, index) in inputPorts" :key="port.id" :id="'port-container-' + port.id"
        class="input port-container"
        :style="portStyles(port, index, true)"
      ></div>
    </div>
    <div class="output port-group">
      <div v-for="(port, index) in outputPorts" :key="port.id" :id="'port-container-' + port.id"
        class="output port-container"
        :style="portStyles(port, index, false)"
      ></div>
    </div>
  </div><!--node-->
  <context-menu ref="contextMenu">
    <!-- context-menu -->
    <!-- common menu items -->
    <li @click="contextMenuRemove"><i class="fas fa-sm fa-times"></i>Remove Node</li>
  </context-menu>
  <transition name="slide-fade-right">
    <option-panel ref="optionPanel" v-if="isActive"
        :nodeLabel="label"
        :initialState="optionPanelInitialState"
        @toggle:iconized="onToggleIconized"
        @toggle:inVisMode="onToggleInVisMode"
        @toggle:labelVisible="onToggleLabelVisible"
    >
      <!-- option-panel -->
    </option-panel>
  </transition>
</div>
